<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<title>Methods: SaveRecordingScript</title>
<style type="text/css">
  body {
    margin: 0px;
    font-family: Tahoma, Arial, sans-serif;
    font-size: 12pt;
  }
  h1 {
    font-size: 14pt;
    font-weight: bold;
  }
  a:link, a:visited {
    color: #0000FF;
  }
  .code {
    font-family: "Courier New", Courier, monospace;
    font-size: 10pt;
  }
  .code .keyword {
    color: #0000FF;
  }
  .code .string {
  	color: #CC0033;
  }
  #footer {
    border-top: 1px solid #CCCCCC;
    color: #CCCCCC;
    font-size: 10pt;
    text-align: center;
  }
  #footer a:link, a:visited {
    color: #CCCCCC;
  }
</style>
</head>

<body>
  <div style="background:url(headerbg.png) repeat-x">
    <div style="background:url(headerimg.png) no-repeat;text-align:center;height:61px;padding-top:17px;font-size:18pt;color:#FFFFFF;white-space:nowrap">Methods: SaveRecordingScript</div>
  </div>
<div style="margin:6px;margin-top:0px">
    <h1>Do something</h1>
    <p>The SaveRecordingScript() method is called, after the user-defined settings are passed to your plugin and any other work from the Control Panel is finished. This function is the main work your plugin has to do. This method returns an object (currently, only strings are supported), or NULL if it was successfully executed.</p>
    <p><em>Note: Only the settings previously set in the <a href="methods_setsettings.html">SetSettings()</a> method are available to you when doing the save work. The Control Panel's settings (username, password, timezone) and the settings in the Preferences dialog are not visible to your plugin because of security reasons!</em></p>
    <p><strong>Definition</strong></p>
  <p class="code"><span class="keyword">object</span> SaveRecordingScript();</p>
    <p><strong>Sample</strong></p>
  <pre class="code"><span class="keyword">
private</span> <span class="keyword">PluginSettingsCollection</span> settings;

<span class="keyword">public</span> <span class="keyword">object</span> SaveRecordingScript()
{
    if (settings[<span class="string">&quot;Destination Folder&quot;</span>].Value == <span class="string">&quot;&quot;</span>)
    {
        <span class="keyword">return</span> <span class="string">&quot;Please enter the folder you want to save the script in.&quot;</span>;
    }

    <span class="keyword">DirectoryInfo</span> di = <span class="keyword">new</span> DirectoryInfo(settings[<span class="string">&quot;Destination Folder&quot;</span>].Value);
    if (di.Exists)
    {
        if (settings[<span class="string">&quot;Destination Filename&quot;</span>].Value == <span class="string">&quot;&quot;</span>)
        {
            <span class="keyword">return</span> <span class="string">&quot;Please enter the name of the script.&quot;</span>;
        }<br />
        <span class="keyword">StreamWriter</span> sw = <span class="keyword">new</span> StreamWriter(di.FullName + <span class="string">&quot;\\&quot;</span> + settings[<span class="string">&quot;Destination Filename&quot;</span>].Value);

        <span class="keyword">string</span> installPath = System.Reflection.Assembly.GetExecutingAssembly().Location.Substring(0, System.Reflection.Assembly.GetExecutingAssembly().Location.LastIndexOf(<span class="string">'\\'</span>));

        sw.WriteLine(<span class="string">&quot;\&quot;&quot;</span> + installPath + <span class="string">&quot;\\OTRRemote.exe&quot;</span> + <span class="string">&quot;\&quot; -a -s=\&quot;CNN\&quot; -sd=2006-10-29 -st=20:00 -et=20:05 -t=\&quot;News\&quot;&quot;</span>);<br />
        sw.Close();
    }
    else
    {
        <span class="keyword">return</span> <span class="string">&quot;The destination folder \&quot;&quot;</span> + di.FullName + <span class="string">&quot;\&quot; was not found. Please check the \&quot;Destination Folder\&quot; setting.&quot;</span>;<br />
    }

    <span class="keyword">return</span> <span class="keyword">null</span>;
}</pre>
</div>
  <div id="footer">Copyright &copy; <a href="http://www.crazysoft.net.ms/" target="_blank">Crazysoft</a> 2006. All rights reserved.</div>
</body>
</html>